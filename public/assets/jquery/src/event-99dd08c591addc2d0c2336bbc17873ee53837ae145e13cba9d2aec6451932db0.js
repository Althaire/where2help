define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/data_priv","./core/init","./data/accepts","./selector"],function(e,t,n,r,i,a,o){function s(){return!0}function u(){return!1}function l(){try{return document.activeElement}catch(e){}}var c=/^key/,d=/^(?:mouse|pointer|contextmenu)|click/,f=/^(?:focusinfocus|focusoutblur)$/,h=/^([^.]*)(?:\.(.+)|)$/;return e.event={global:{},add:function(r,i,a,s,u){var l,c,d,f,p,m,g,v,y,_,b,T=o.get(r);if(T)for(a.handler&&(l=a,a=l.handler,u=l.selector),a.guid||(a.guid=e.guid++),(f=T.events)||(f=T.events={}),(c=T.handle)||(c=T.handle=function(n){return typeof e!==t&&e.event.triggered!==n.type?e.event.dispatch.apply(r,arguments):void 0}),i=(i||"").match(n)||[""],p=i.length;p--;)d=h.exec(i[p])||[],y=b=d[1],_=(d[2]||"").split(".").sort(),y&&(g=e.event.special[y]||{},y=(u?g.delegateType:g.bindType)||y,g=e.event.special[y]||{},m=e.extend({type:y,origType:b,data:s,handler:a,guid:a.guid,selector:u,needsContext:u&&e.expr.match.needsContext.test(u),namespace:_.join(".")},l),(v=f[y])||(v=f[y]=[],v.delegateCount=0,g.setup&&g.setup.call(r,s,_,c)!==!1||r.addEventListener&&r.addEventListener(y,c,!1)),g.add&&(g.add.call(r,m),m.handler.guid||(m.handler.guid=a.guid)),u?v.splice(v.delegateCount++,0,m):v.push(m),e.event.global[y]=!0)},remove:function(t,r,i,a,s){var u,l,c,d,f,p,m,g,v,y,_,b=o.hasData(t)&&o.get(t);if(b&&(d=b.events)){for(r=(r||"").match(n)||[""],f=r.length;f--;)if(c=h.exec(r[f])||[],v=_=c[1],y=(c[2]||"").split(".").sort(),v){for(m=e.event.special[v]||{},v=(a?m.delegateType:m.bindType)||v,g=d[v]||[],c=c[2]&&new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=u=g.length;u--;)p=g[u],!s&&_!==p.origType||i&&i.guid!==p.guid||c&&!c.test(p.namespace)||a&&a!==p.selector&&("**"!==a||!p.selector)||(g.splice(u,1),p.selector&&g.delegateCount--,m.remove&&m.remove.call(t,p));l&&!g.length&&(m.teardown&&m.teardown.call(t,y,b.handle)!==!1||e.removeEvent(t,v,b.handle),delete d[v])}else for(v in d)e.event.remove(t,v+r[f],i,a,!0);e.isEmptyObject(d)&&(delete b.handle,o.remove(t,"events"))}},trigger:function(t,n,i,a){var s,u,l,c,d,h,p,m=[i||document],g=r.call(t,"type")?t.type:t,v=r.call(t,"namespace")?t.namespace.split("."):[];if(u=l=i=i||document,3!==i.nodeType&&8!==i.nodeType&&!f.test(g+e.event.triggered)&&(g.indexOf(".")>=0&&(v=g.split("."),g=v.shift(),v.sort()),d=g.indexOf(":")<0&&"on"+g,t=t[e.expando]?t:new e.Event(g,"object"==typeof t&&t),t.isTrigger=a?2:3,t.namespace=v.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:e.makeArray(n,[t]),p=e.event.special[g]||{},a||!p.trigger||p.trigger.apply(i,n)!==!1)){if(!a&&!p.noBubble&&!e.isWindow(i)){for(c=p.delegateType||g,f.test(c+g)||(u=u.parentNode);u;u=u.parentNode)m.push(u),l=u;l===(i.ownerDocument||document)&&m.push(l.defaultView||l.parentWindow||window)}for(s=0;(u=m[s++])&&!t.isPropagationStopped();)t.type=s>1?c:p.bindType||g,h=(o.get(u,"events")||{})[t.type]&&o.get(u,"handle"),h&&h.apply(u,n),h=d&&u[d],h&&h.apply&&e.acceptData(u)&&(t.result=h.apply(u,n),t.result===!1&&t.preventDefault());return t.type=g,a||t.isDefaultPrevented()||p._default&&p._default.apply(m.pop(),n)!==!1||!e.acceptData(i)||d&&e.isFunction(i[g])&&!e.isWindow(i)&&(l=i[d],l&&(i[d]=null),e.event.triggered=g,i[g](),e.event.triggered=void 0,l&&(i[d]=l)),t.result}},dispatch:function(t){t=e.event.fix(t);var n,r,a,s,u,l=[],c=i.call(arguments),d=(o.get(this,"events")||{})[t.type]||[],f=e.event.special[t.type]||{};if(c[0]=t,t.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,t)!==!1){for(l=e.event.handlers.call(this,t,d),n=0;(s=l[n++])&&!t.isPropagationStopped();)for(t.currentTarget=s.elem,r=0;(u=s.handlers[r++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(u.namespace))&&(t.handleObj=u,t.data=u.data,a=((e.event.special[u.origType]||{}).handle||u.handler).apply(s.elem,c),void 0!==a&&(t.result=a)===!1&&(t.preventDefault(),t.stopPropagation()));return f.postDispatch&&f.postDispatch.call(this,t),t.result}},handlers:function(t,n){var r,i,a,o,s=[],u=n.delegateCount,l=t.target;if(u&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==t.type){for(i=[],r=0;u>r;r++)o=n[r],a=o.selector+" ",void 0===i[a]&&(i[a]=o.needsContext?e(a,this).index(l)>=0:e.find(a,this,null,[l]).length),i[a]&&i.push(o);i.length&&s.push({elem:l,handlers:i})}return u<n.length&&s.push({elem:this,handlers:n.slice(u)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,a=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||document,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(t){if(t[e.expando])return t;var n,r,i,a=t.type,o=t,s=this.fixHooks[a];for(s||(this.fixHooks[a]=s=d.test(a)?this.mouseHooks:c.test(a)?this.keyHooks:{}),i=s.props?this.props.concat(s.props):this.props,t=new e.Event(o),n=i.length;n--;)r=i[n],t[r]=o[r];return t.target||(t.target=document),3===t.target.nodeType&&(t.target=t.target.parentNode),s.filter?s.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&e.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return e.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(t,n,r,i){var a=e.extend(new e.Event,r,{type:t,isSimulated:!0,originalEvent:{}});i?e.event.trigger(a,null,n):e.event.dispatch.call(n,a),a.isDefaultPrevented()&&r.preventDefault()}},e.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},e.Event=function(t,n){return this instanceof e.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?s:u):this.type=t,n&&e.extend(this,n),this.timeStamp=t&&t.timeStamp||e.now(),void(this[e.expando]=!0)):new e.Event(t,n)},e.Event.prototype={isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=s,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=s,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=s,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},e.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,n){e.event.special[t]={delegateType:n,bindType:n,handle:function(t){var r,i=this,a=t.relatedTarget,o=t.handleObj;return(!a||a!==i&&!e.contains(i,a))&&(t.type=o.origType,r=o.handler.apply(this,arguments),t.type=n),r}}}),a.focusinBubbles||e.each({focus:"focusin",blur:"focusout"},function(t,n){var r=function(t){e.event.simulate(n,t.target,e.event.fix(t),!0)};e.event.special[n]={setup:function(){var e=this.ownerDocument||this,i=o.access(e,n);i||e.addEventListener(t,r,!0),o.access(e,n,(i||0)+1)},teardown:function(){var e=this.ownerDocument||this,i=o.access(e,n)-1;i?o.access(e,n,i):(e.removeEventListener(t,r,!0),o.remove(e,n))}}}),e.fn.extend({on:function(t,n,r,i,a){var o,s;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(s in t)this.on(s,n,r,t[s],a);return this}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),i===!1)i=u;else if(!i)return this;return 1===a&&(o=i,i=function(t){return e().off(t),o.apply(this,arguments)},i.guid=o.guid||(o.guid=e.guid++)),this.each(function(){e.event.add(this,t,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(t,n,r){var i,a;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,e(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(a in t)this.off(a,n,t[a]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=void 0),r===!1&&(r=u),this.each(function(){e.event.remove(this,t,r,n)})},trigger:function(t,n){return this.each(function(){e.event.trigger(t,n,this)})},triggerHandler:function(t,n){var r=this[0];return r?e.event.trigger(t,n,r,!0):void 0}}),e});